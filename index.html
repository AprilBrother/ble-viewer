<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8">
    <title>Hello World!</title>
    <link href="node_modules/bootstrap/dist/css/bootstrap.min.css" rel="stylesheet">

  </head>
  <body>
    <h1>Hello World!</h1>

    <form>
        <input type="text" name="mqtt-host" placeholder="MQTT Host" value="mqtt.bconimg.com">
        <input type="number" name="mqtt-port" placeholder="MQTT Port" value="1883">
        <input type="text" name="mqtt-topic" placeholder="Topic" value="hello">
        <input type="text" name="mqtt-username" placeholder="MQTT Username">
        <input type="text" name="mqtt-password"  placeholder="MQTT Password">
        <button id="btn-test" type="button">Test</button>
    </form>

    <script>
    window.$ = window.jQuery = require('./node_modules/jquery/dist/jquery.min');
    // You can also require other files to run in this process
    require('./renderer.js')
    </script>
    <script src="./node_modules/bootstrap/dist/js/bootstrap.min.js"></script>
    <script>
        $("#btn-test").click(function() {
            var mqtt = require('mqtt')
                host = 'mqtt://' + $('input[name=mqtt-host]').val()
                port = parseInt($('input[name=mqtt-port]').val())

            var client  = mqtt.connect(host, {
                port: port
            })

            client.on('connect', function () {
                console.log("connected")
                client.subscribe("/beacons")
            })

            client.on('message', function (topic, message) {
              // message is Buffer
              console.log(message.toString())
              //client.end()
            })

        });
    </script>
  </body>
</html>
